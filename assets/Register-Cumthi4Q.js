import{u as N}from"./vue-core-C_l77I1y.js";import{b as w,a as x}from"./index-CgfAAbnT.js";import"vue";const y={class:"wrapper"},C={class:"register-form"},B={__name:"Register",setup(b){const c=N(),m=Vue.ref(""),a=Vue.ref(""),n=Vue.ref(""),d=Vue.ref(""),l=Vue.ref(60);let u;const p=Vue.computed(()=>/^1\d{10}$/.test(a.value)),_=async()=>{if(console.log("开始计时"),l.value===60){console.log("启动倒计时"),l.value=60,u=setInterval(()=>{l.value--,console.log("time: ",l.value),l.value<=0&&(clearInterval(u),l.value=60)},1e3),console.log("开始问后端要验证码");const t=await x(a.value,"r");console.log(t),t.code===1&&(r(t.msg),l.value&&(l.value=60,clearInterval(u),u=null))}},r=t=>{ElementPlus.ElMessage.error(t)},v=async()=>{if(!p.value){r("手机号不正确");return}if(!/^\d{4}$/.test(n.value)){r("验证码必须是4位数字");return}const t=await w(a.value,n.value,d.value);console.log(t),l.value&&(l.value=60,clearInterval(u),u=null),t.code===0?(await ElementPlus.ElMessageBox.alert("注册成功，将返回系统登录界面","注册情况",{confirmButtonText:"确定",type:"success"}),c.push("/login")):r(t.msg)},f=()=>{c.push("/login")};return(t,e)=>{const s=Vue.__unplugin_components_0,V=Vue.__unplugin_components_1,i=Vue.__unplugin_components_2,g=Vue.__unplugin_components_3;return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[e[7]||(e[7]=Vue.createElementVNode("div",{class:"header"},[Vue.createElementVNode("p",null,"互感器二次压降检测仪检定系统")],-1)),Vue.createElementVNode("div",y,[e[6]||(e[6]=Vue.createElementVNode("h1",null,"▎账户注册",-1)),Vue.createElementVNode("div",C,[Vue.createVNode(g,{onSubmit:Vue.withModifiers(v,["prevent"])},{default:Vue.withCtx(()=>[Vue.createVNode(V,{label:"账户名称："},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),placeholder:"请输入账户名称"},null,8,["modelValue"])]),_:1}),Vue.createVNode(V,{label:"手机号码："},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value=o),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1}),Vue.createVNode(V,{label:"验证码："},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value=o),placeholder:"请输入验证码",style:{flex:"1"}},null,8,["modelValue"]),Vue.createVNode(i,{disabled:!p.value,type:"primary",style:{right:"0"},onClick:_},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(l.value<60?`${l.value}秒后重试`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1}),Vue.createVNode(V,{label:"密码："},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=o=>d.value=o),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),Vue.createVNode(i,{type:"primary",class:"backBtn",onClick:f},{default:Vue.withCtx(()=>e[4]||(e[4]=[Vue.createTextVNode(" 返回登录 ")])),_:1}),Vue.createVNode(i,{type:"primary",class:"registerBtn",onClick:v},{default:Vue.withCtx(()=>e[5]||(e[5]=[Vue.createTextVNode(" 确定注册 ")])),_:1})]),_:1})])])],64)}}};export{B as default};
