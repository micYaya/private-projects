import{e as r,f as x,c as C,g as d,a as o,w as t,k as E,F as I,i as U,u as F,o as T,l as M,m as N,p as S,q as g,t as $,L as h,s as q}from"./vue-core-ejNiufTe.js";import{r as L,b as R}from"./index-C-2LZmHF.js";const A={class:"wrapper"},D={class:"register-form"},G={__name:"Register",setup(P){const _=F(),V=r(""),u=r(""),i=r(""),c=r(""),l=r(60);let n;const y=x(()=>/^1\d{10}$/.test(u.value)),b=async()=>{if(console.log("开始计时"),l.value===60){console.log("启动倒计时"),l.value=60,n=setInterval(()=>{l.value--,console.log("time: ",l.value),l.value<=0&&(clearInterval(n),l.value=60)},1e3),console.log("开始问后端要验证码");const a=await L(u.value,"r");console.log(a),a.code===1&&(m(a.msg),l.value&&(l.value=60,clearInterval(n),n=null))}},m=a=>{q.error(a)},w=async()=>{if(!y.value){m("手机号不正确");return}if(!/^\d{4}$/.test(i.value)){m("验证码必须是4位数字");return}const a=await R(u.value,i.value,c.value);console.log(a),l.value&&(l.value=60,clearInterval(n),n=null),a.code===0?(await h.alert("注册成功，将返回系统登录界面","注册情况",{confirmButtonText:"确定",type:"success"}),_.push("/login")):m(a.msg)},k=()=>{_.push("/login")};return(a,e)=>{const p=N,v=M,f=S,B=U;return T(),C(I,null,[e[7]||(e[7]=d("div",{class:"header"},[d("p",null,"互感器二次压降检测仪检定系统")],-1)),d("div",A,[e[6]||(e[6]=d("h1",null,"▎账户注册",-1)),d("div",D,[o(B,{onSubmit:E(w,["prevent"])},{default:t(()=>[o(v,{label:"账户名称："},{default:t(()=>[o(p,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=s=>V.value=s),placeholder:"请输入账户名称"},null,8,["modelValue"])]),_:1}),o(v,{label:"手机号码："},{default:t(()=>[o(p,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1}),o(v,{label:"验证码："},{default:t(()=>[o(p,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),placeholder:"请输入验证码",style:{flex:"1"}},null,8,["modelValue"]),o(f,{disabled:!y.value,type:"primary",style:{right:"0"},onClick:b},{default:t(()=>[g($(l.value<60?`${l.value}秒后重试`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1}),o(v,{label:"密码："},{default:t(()=>[o(p,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),o(f,{type:"primary",class:"backBtn",onClick:k},{default:t(()=>e[4]||(e[4]=[g(" 返回登录 ")])),_:1}),o(f,{type:"primary",class:"registerBtn",onClick:w},{default:t(()=>e[5]||(e[5]=[g(" 确定注册 ")])),_:1})]),_:1})])])],64)}}};export{G as default};
